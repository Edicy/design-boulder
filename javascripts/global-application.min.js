var MMCQ,PriorityQueue;PriorityQueue=function(){function t(t){this.comparator=t,this.contents=[],this.sorted=!1}return t.prototype.sort=function(){return this.contents.sort(this.comparator),this.sotred=!0},t.prototype.push=function(t){return this.contents.push(t),this.sorted=!1},t.prototype.peek=function(t){return null==t&&(t=this.contents.length-1),this.sorted||this.sort(),this.contents[t]},t.prototype.pop=function(){return this.sorted||this.sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(t){return this.contents.map(t)},t}(),MMCQ=function(){function t(){this.maxIterations=1e3,this.fractByPopulations=.75}var e,o,r,n,s,i;return t.sigbits=5,t.rshift=8-t.sigbits,n=function(e,o,r){return(e<<2*t.sigbits)+(o<<t.sigbits)+r},e=function(){function e(t,e,o,r,n,s,i){this.r1=t,this.r2=e,this.g1=o,this.g2=r,this.b1=n,this.b2=s,this.histo=i}return e.prototype.volume=function(t){return this._volume&&!t||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},e.prototype.count=function(t){var e,o,r,s,i,a,c,u,h,l,g;if(!this._count_set||t){for(s=0,i=a=this.r1,h=this.r2;a<=h;i=a+=1)for(o=c=this.g1,l=this.g2;c<=l;o=c+=1)for(e=u=this.b1,g=this.b2;u<=g;e=u+=1)r=n(i,o,e),s+=this.histo[r]||0;this._count_set=!0,this._count=s}return this._count},e.prototype.copy=function(){return new e(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},e.prototype.average=function(e){var o,r,s,i,a,c,u,h,l,g,f,p,d,m,b,v;if(!this._average||e){for(u=1<<8-t.sigbits,g=0,l=0,i=0,r=0,h=f=this.r1,m=this.r2;f<=m;h=f+=1)for(s=p=this.g1,b=this.g2;p<=b;s=p+=1)for(o=d=this.b1,v=this.b2;d<=v;o=d+=1)c=n(h,s,o),g+=a=this.histo[c]||0,l+=a*(h+.5)*u,i+=a*(s+.5)*u,r+=a*(o+.5)*u;this._average=g?[~~(l/g),~~(i/g),~~(r/g)]:[~~(u*(this.r1+this.r2+1)/2),~~(u*(this.g1+this.g2+1)/2),~~(u*(this.b1+this.b2+1)/2)]}return this._average},e.prototype.contains=function(e){var o,r,n;return n=e[0]>>t.rshift,r=e[1]>>t.rshift,o=e[2]>>t.rshift,this.r1<=n&&n<=this.r2&&this.g1<=r&&r<=this.g2&&this.b1<=o&&o<=this.b2},e}(),o=function(){function t(){this.cboxes=new PriorityQueue(function(t,e){var o,r;return o=t.count()*t.volume(),r=e.count()*e.volume(),o>r?1:o<r?-1:0})}return t.prototype.push=function(t){return this.cboxes.push({cbox:t,color:t.average()})},t.prototype.palette=function(){return this.cboxes.map(function(t){return t.color})},t.prototype.size=function(){return this.cboxes.size()},t.prototype.map=function(t){var e,o,r;for(e=o=0,r=this.cboxes.size();o<r;e=o+=1)return this.cboxes.peek(e).cbox.contains(t)?this.cboxes.peek(e).color:this.nearest(t)},t.prototype.cboxes=function(){return this.cboxes},t.prototype.nearest=function(t){var e,o,r,n,s,i,a;for(s=function(t){return t*t},r=1e9,o=i=0,a=this.cboxes.size();i<a;o=i+=1)(e=Math.sqrt(s(t[0]-this.cboxes.peek(o).color[0])+s(t[1]-this.cboxes.peek(o).color[1])+s(t[2]-this.cboxes.peek(o).color[2])))<r&&(r=e,n=this.cboxes.peek(o).color);return n},t}(),s=function(e){var o,r,s,i,a,c,u,h,l;for(i=1<<3*t.sigbits,s=new Array(i),h=0,l=e.length;h<l;h++)u=(c=e[h])[0]>>t.rshift,r=c[1]>>t.rshift,o=c[2]>>t.rshift,s[a=n(u,r,o)]=(s[a]||0)+1;return s},r=function(o,r){var n,s,i,a,c,u,h,l,g,f,p,d;for(f=1e6,g=0,u=1e6,c=0,i=1e6,s=0,p=0,d=o.length;p<d;p++)l=(h=o[p])[0]>>t.rshift,a=h[1]>>t.rshift,n=h[2]>>t.rshift,l<f?f=l:l>g&&(g=l),a<u?u=a:a>c&&(c=a),n<i?i=n:n>s&&(s=n);return new e(f,g,u,c,i,s,r)},i=function(t,e){var o,r,s,i,a,c,u,h,l,g,f,p,d,m,b,v,C,y,x,j,w,k,B,_,M,z,P,I,S,D;if(e.count()){if(1===e.count())return[e.copy()];if(g=e.r2-e.r1+1,a=e.g2-e.g1+1,r=e.b2-e.b1+1,u=Math.max(g,a,r),p=0,h=[],c=[],u===g)for(l=d=e.r1,k=e.r2;d<=k;l=d+=1){for(f=0,i=m=e.g1,P=e.g2;m<=P;i=m+=1)for(o=b=e.b1,I=e.b2;b<=I;o=b+=1)f+=t[n(l,i,o)]||0;p+=f,h[l]=p}else if(u===a)for(i=v=e.g1,S=e.g2;v<=S;i=v+=1){for(f=0,l=C=e.r1,D=e.r2;C<=D;l=C+=1)for(o=y=e.b1,B=e.b2;y<=B;o=y+=1)f+=t[n(l,i,o)]||0;p+=f,h[i]=p}else for(o=x=e.b1,_=e.b2;x<=_;o=x+=1){for(f=0,l=j=e.r1,M=e.r2;j<=M;l=j+=1)for(i=w=e.g1,z=e.g2;w<=z;i=w+=1)f+=t[n(l,i,o)]||0;p+=f,h[o]=p}return h.forEach(function(t,e){return c[e]=p-t}),s=function(t){var o,r,n,s,i,a,u,l,g,f,d;for(a=t+"2",u=f=e[i=t+"1"],d=e[a];f<=d;u=f+=1)if(h[u]>p/2){for(o=e.copy(),r=e.copy(),s=(l=u-e[i])<=(g=e[a]-u)?Math.min(e[a]-1,~~(u+g/2)):Math.max(e[i],~~(u-1-l/2));!h[s];)s++;for(n=c[s];!n&&h[s-1];)n=c[--s];return o[a]=s,r[i]=o[a]+1,[o,r]}},u===g?s("r"):u===a?s("g"):u===r?s("b"):void 0}},t.prototype.quantize=function(t,e){var n,a,c,u,h,l,g=this;if(!t.length||e<2||e>256)return console.log("invalid arguments"),!1;for(c=s(t),n=r(t,c),(h=new PriorityQueue(function(t,e){var o,r;return o=t.count(),r=e.count(),o>r?1:o<r?-1:0})).push(n),(u=function(t,e){var o,r,s,a,u;for(a=1,u=0;u<g.maxIterations;)if((n=t.pop()).count()){if(s=i(c,n),o=s[0],r=s[1],!o)return void console.log("cbox1 not defined; shouldn't happen");if(t.push(o),r&&(t.push(r),a++),a>=e)return;if(u++>g.maxIterations)return void console.log("infinite loop; perhaps too few pixels")}else t.push(n),u++})(h,this.fractByPopulations*e),l=new PriorityQueue(function(t,e){var o,r;return o=t.count()*t.volume(),r=e.count()*e.volume(),o>r?1:o<r?-1:0});h.size();)l.push(h.pop());for(u(l,e-l.size()),a=new o;l.size();)a.push(l.pop());return a},t}.call(this),function(){window.ColorExtract=function(){function t(){}return t.getColorMap=function(t,e,o,r,n,s){var i,a,c,u,h,l,g,f,p,d;for(null==s&&(s=8),c=t.getContext("2d").getImageData(e,o,r,n).data,u=[],l=g=o,p=o+n;g<p;l=g+=1)for(a=l*r*4,h=f=e,d=e+r;f<d;h=f+=1)i=a+4*h,u.push([c[i],c[i+1],c[i+2]]);return(new MMCQ).quantize(u,s)},t.colorDist=function(t,e){var o;return(o=function(t){return t*t})(t[0]-e[0])+o(t[1]-e[1])+o(t[2]-e[2])},t.extract=function(e,o,r){var n,s,i,a,c,u,h,l,g,f,p,d,m;for(o.width=25,o.height=25,o.getContext("2d").drawImage(e,0,0,o.width,o.height),(s=t.getColorMap(o,0,0,o.width,o.height,4).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,e){return e.count-t.count}),n=s[0].rgb,(h=t.getColorMap(o,0,0,e.width,e.height,10).cboxes.map(function(t){return{count:t.cbox.count(),rgb:t.color}})).sort(function(t,e){return e.count-t.count}),l=0,f=0,d=h.length;f<d;f++)i=h[f],(a=t.colorDist(n,i.rgb))>l&&(l=a,c=i.rgb);for(l=0,p=0,m=h.length;p<m;p++)i=h[p],(a=t.colorDist(n,i.rgb))>l&&i.rgb!==c&&(l=a,u=i.rgb);return g=function(t){return"rgb("+t[0]+", "+t[1]+", "+t[2]+")"},r({bgColor:g(n),fgColor:g(c),fgColor2:g(u)})},t}()}.call(this),function(t){var e=t("html").hasClass("editmode"),o=function(){var e=t(window).width(),o=t(".js-search"),r=t(".js-menu-btn");e<=640?o.next().is(r)&&o.before(r):o.prev().is(r)&&o.after(r)},r=function(){headerBgCombinedLightness>=.5?t(".js-background-type").addClass("light-background").removeClass("dark-background"):t(".js-background-type").addClass("dark-background").removeClass("light-background")},n=function(e,o){return function(e,o){if(e&&o){"string"==typeof e&&(e=e.replace(/rgba?\(/,"").replace(/\)/,"").split(","),t.each(e,function(t,o){e[t]=+o})),"string"==typeof o&&(o=o.replace(/rgba?\(/,"").replace(/\)/,"").split(","),t.each(o,function(t,e){o[t]=+e})),"object"==typeof e&&e.hasOwnProperty("length")&&3==e.length&&e.push(1),"object"==typeof o&&o.hasOwnProperty("length")&&3==o.length&&o.push(1);var r=[0,0,0,0];return r[3]=1-(1-o[3])*(1-e[3]),0===r[3]&&(r[3]=1e-6),r[0]=Math.min(o[0]*o[3]/r[3]+e[0]*e[3]*(1-o[3])/r[3],255),r[1]=Math.min(o[1]*o[3]/r[3]+e[1]*e[3]*(1-o[3])/r[3],255),r[2]=Math.min(o[2]*o[3]/r[3]+e[2]*e[3]*(1-o[3])/r[3],255),t.map(r,function(t){return Math.floor(t)})}}(e||[255,255,255,1],o||[255,255,255,1])},s=function(t,e){var o=n(t,e);return Math.round((.2126*+o[0]+.7152*+o[1]+.0722*+o[2])/2.55)/100},i=function(){t(window).resize(function(t,e,o){var r;return function(){var n=this,s=arguments,i=o&&!r;clearTimeout(r),r=setTimeout(function(){r=null,o||t.apply(n,s)},e),i&&t.apply(n,s)}}(o,1e3))};window.site=t.extend(window.site||{},{initBlogPage:function(){},initArticlePage:function(){},initCommonPage:function(){},initFrontPage:function(){},toggleFlags:function(){t(".js-option-toggle-flags").on("click",function(){if(t(this).hasClass("js-flag-disable-btn"))var e=!1;else e=!0;siteData.set("flags_state",e),t(this).toggleClass("js-flag-disable-btn"),t(".js-menu-lang").toggleClass("flags-enabled flags-disabled")})},headerBgPreview:function(e,o){var n=t(".js-bgpicker-header-image").css("background-image"),i=e.imageSizes?function(t,e){for(var o,r=0,n=t.length;r<n;r++){if(t[r].width<e)return o||t[r];o=t[r]}return t[t.length-1]}(e.imageSizes,t(window).width()):null,a=e.image&&""!==e.image?"url("+i.url+")":"none",c=e.imageSizes&&""!==e.imageSizes?e.imageSizes:null,u=e.color&&""!==e.color?e.color:"rgba(0,0,0,0)",h=(e.colorData&&""!==e.colorData&&e.colorData.lightness,t("<img>")),l=t("<canvas>"),g=e.image&&""!==e.image?e.image:null;g?function(t,e){for(var o=t.length;o--;)if(e.indexOf(t[o].url.trim())>-1)return!0;return!1}(c,n)?(headerBg.headerBgImageColor=headerBg.headerBgImageColor?headerBg.headerBgImageColor:"rgba(103,103,110,1)",headerBgCombinedLightness=s(headerBg.headerBgImageColor,u),r()):(h.attr("src",g.replace(/.*\/(photos|voogstock)/g,"/photos")),h.on("load",function(){ColorExtract.extract(h[0],l[0],function(t){headerBg.headerBgImageColor=t.bgColor?t.bgColor:"rgba(255,255,255,1)",headerBgCombinedLightness=s(headerBg.headerBgImageColor,u),r()})})):(headerBg.headerBgImageColor="rgba(255,255,255,1)",headerBgCombinedLightness=s("rgba(255,255,255,1)",u),r()),t(o).find(".js-bgpicker-header-image").css({"background-image":a}),t(o).find(".js-bgpicker-header-color").css({"background-color":u})},headerBgCommit:function(e,o){var r=t.extend(!0,{},e);r.image=e.image||"",r.imageSizes=e.imageSizes||"",r.color=e.color||"rgba(255,255,255,0)",r.combinedLightness=headerBgCombinedLightness,pageData.set(o,r)},bindCustomTexteditorStyles:function(t){window.edy=window.edy||[],edy.push(["texteditorStyles",{name:t,tagname:"a",attribute:{href:"#"},classname:"custom-btn",toggle:!0}])},bindSiteSearch:function(e,o,r){e&&new VoogSearch(e,{per_page:10,lang:o,resultsContainer:t(".js-voog-search-modal-inner").get(0),sideclick:!0,mobileModeWidth:640,updateOnKeypress:!0,noResults:r})}}),t(".js-container").on("mousedown",function(e){t(e.target).closest(".js-prevent-sideclick").length||(t(".js-popover").removeClass("expanded"),t("body").removeClass("search-open"),t(".js-search-open-btn").removeClass("open"),t(".js-search-close-btn").removeClass("open"),t(".js-search").removeClass("active"))}),t(".js-menu-btn").click(function(){t(this).toggleClass("open"),t(".js-menu-main").toggleClass("expanded"),t(".js-search-close-btn").hasClass("open")&&t(".js-search-close-btn").trigger("click")}),t(".js-menu-lang-btn").click(function(){t(".js-menu-lang-popover").toggleClass("expanded")}),t(".js-search-open-btn").click(function(){t(".js-menu-main").hasClass("expanded")&&(t(".js-menu-main").removeClass("expanded"),t(".js-menu-btn").removeClass("open")),t(this).addClass("open"),t("body").addClass("search-open"),t(".js-search-close-btn").addClass("open"),t(".js-search").addClass("active"),t(".js-search-inner").css({"margin-top":"-25px"}),t(".js-search-input").val("").focus()}),t(".js-search-close-btn").click(function(){t(this).removeClass("open"),t("body").removeClass("search-open"),t(".js-search-open-btn").removeClass("open"),t(".js-search").removeClass("active")}),t(".js-search").click(function(){}),o(),t(".js-search-submit").on("click",function(){t(".js-search-input").parent().blur()}),i(),e||t.each(t('.content-formatted:not(".js-custom-content-formatted") table'),function(){t(this).wrap('<div class="table-container overthrow"></div>')}),t(document).ready(function(){t(".comment-form").hasClass("form_with_errors")?t("html, body").scrollTop(t(".comment-form").offset().top):t("form").find(".form_error, .form_notice").length>0&&t("html, body").scrollTop(t(".form_error, .form_notice").closest("form").offset().top)})}(jQuery);